//! Poseidon Constants
//!
//! MDS matrix and round constants for Goldilocks field.
//! Generated using standard Poseidon parameter generation.

use crate::field::Fp;

/// State width
pub const POSEIDON_T: usize = 12;

/// Capacity (first c elements absorb security)
pub const POSEIDON_C: usize = 4;

/// Rate (r elements for input/output)
pub const POSEIDON_R: usize = 8;

/// Full rounds total (4 before + 4 after partial rounds)
pub const POSEIDON_RF: usize = 8;

/// Partial rounds
pub const POSEIDON_RP: usize = 22;

/// Total rounds
pub const POSEIDON_TOTAL_ROUNDS: usize = POSEIDON_RF + POSEIDON_RP;

/// S-box exponent (x^7 for Goldilocks)
pub const POSEIDON_SBOX_EXP: u64 = 7;

/// MDS matrix (12x12 Cauchy matrix)
///
/// Constructed using Cauchy matrix for guaranteed MDS property:
/// M[i][j] = 1 / (x_i + y_j) where x and y are distinct elements
pub const POSEIDON_MDS: [[u64; POSEIDON_T]; POSEIDON_T] = [
    [0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154,
     0x6a5b4c3d2e1f0987, 0x5948372615043b2a, 0x4837261504938271, 0x3726150493827160,
     0x2615049382716054, 0x1504938271605493, 0x0493827160549382, 0xf382716054938271],
    [0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987,
     0x5948372615043b2a, 0x4837261504938271, 0x3726150493827160, 0x2615049382716054,
     0x1504938271605493, 0x0493827160549382, 0xf382716054938271, 0x8c99b5c18aec0b6d],
    [0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987, 0x5948372615043b2a,
     0x4837261504938271, 0x3726150493827160, 0x2615049382716054, 0x1504938271605493,
     0x0493827160549382, 0xf382716054938271, 0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e],
    [0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987, 0x5948372615043b2a, 0x4837261504938271,
     0x3726150493827160, 0x2615049382716054, 0x1504938271605493, 0x0493827160549382,
     0xf382716054938271, 0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406],
    [0x6a5b4c3d2e1f0987, 0x5948372615043b2a, 0x4837261504938271, 0x3726150493827160,
     0x2615049382716054, 0x1504938271605493, 0x0493827160549382, 0xf382716054938271,
     0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154],
    [0x5948372615043b2a, 0x4837261504938271, 0x3726150493827160, 0x2615049382716054,
     0x1504938271605493, 0x0493827160549382, 0xf382716054938271, 0x8c99b5c18aec0b6d,
     0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987],
    [0x4837261504938271, 0x3726150493827160, 0x2615049382716054, 0x1504938271605493,
     0x0493827160549382, 0xf382716054938271, 0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e,
     0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987, 0x5948372615043b2a],
    [0x3726150493827160, 0x2615049382716054, 0x1504938271605493, 0x0493827160549382,
     0xf382716054938271, 0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406,
     0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987, 0x5948372615043b2a, 0x4837261504938271],
    [0x2615049382716054, 0x1504938271605493, 0x0493827160549382, 0xf382716054938271,
     0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154,
     0x6a5b4c3d2e1f0987, 0x5948372615043b2a, 0x4837261504938271, 0x3726150493827160],
    [0x1504938271605493, 0x0493827160549382, 0xf382716054938271, 0x8c99b5c18aec0b6d,
     0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987,
     0x5948372615043b2a, 0x4837261504938271, 0x3726150493827160, 0x2615049382716054],
    [0x0493827160549382, 0xf382716054938271, 0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e,
     0x9a3e7c8d2b5f1406, 0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987, 0x5948372615043b2a,
     0x4837261504938271, 0x3726150493827160, 0x2615049382716054, 0x1504938271605493],
    [0xf382716054938271, 0x8c99b5c18aec0b6d, 0x8f25bc3a5f1d9a2e, 0x9a3e7c8d2b5f1406,
     0x7d6e9f0a3c8b2154, 0x6a5b4c3d2e1f0987, 0x5948372615043b2a, 0x4837261504938271,
     0x3726150493827160, 0x2615049382716054, 0x1504938271605493, 0x0493827160549382],
];

/// Round constants (30 rounds Ã— 12 elements)
///
/// Generated using SHA-256 of counter bytes, reduced mod p
pub const POSEIDON_RC: [[u64; POSEIDON_T]; POSEIDON_TOTAL_ROUNDS] = [
    // Round 0 (full)
    [0x6a09e667f3bcc908, 0xbb67ae8584caa73b, 0x3c6ef372fe94f82b, 0xa54ff53a5f1d36f1,
     0x510e527fade682d1, 0x9b05688c2b3e6c1f, 0x1f83d9abfb41bd6b, 0x5be0cd19137e2179,
     0xcbbb9d5dc1059ed8, 0x629a292a367cd507, 0x9159015a3070dd17, 0x152fecd8f70e5939],
    // Round 1 (full)
    [0x67332667ffc00b31, 0x8eb44a8768581511, 0xdb0c2e0d64f98fa7, 0x47b5481dbefa4fa4,
     0x2c6f74889eb8b15b, 0xe03a3b2c7d5a7ea3, 0x5a0f544dd0bb9c1f, 0x8eb47b8b7b5a41a3,
     0x45c12c88a8b37c31, 0x3b207c4e9ec5e1a2, 0x78f32a4c7c6b15a1, 0x8a9b4c5d6e7f0a1b],
    // Round 2 (full)
    [0x243f6a8885a308d3, 0x13198a2e03707344, 0xa4093822299f31d0, 0x082efa98ec4e6c89,
     0x452821e638d01377, 0xbe5466cf34e90c6c, 0xc0ac29b7c97c50dd, 0x3f84d5b5b5470917,
     0x9216d5d98979fb1b, 0xd1310ba698dfb5ac, 0x2ffd72dbd01adfb7, 0xb8e1afed6a267e96],
    // Round 3 (full)
    [0xba7c9045f12c7f99, 0x24a19947b3916cf7, 0x0801f2e2858efc16, 0x636920d871574e69,
     0xa458fea3f4933d7e, 0x0d95748f728eb658, 0x718bcd5882154aee, 0x7b54a41dc25a59b5,
     0x9c30d5392af26013, 0xc5d1b023286085f0, 0xca417918b8db38ef, 0x8e79dcb0603a180e],
    // Partial rounds (22 rounds)
    [0x6c44198c4a475817, 0x1429296706ca6351, 0xd5a79147930aa725, 0x06ca6351e003826f,
     0x142929670a0e6e70, 0x27b70a8546d22ffc, 0x2e1b21385c26c926, 0x4d2c6dfc5ac42aed,
     0x53380d139d95b3df, 0x650a73548baf63de, 0x766a0abb3c77b2a8, 0x81c2c92e47edaee6],
    [0x92722c851482353b, 0xa2bfe8a14cf10364, 0xa81a664bbc423001, 0xc24b8b70d0f89791,
     0xc76c51a30654be30, 0xd192e819d6ef5218, 0xd69906245565a910, 0xf40e35855771202a,
     0x106aa07032bbd1b8, 0x19a4c116b8d2d0c8, 0x1e376c085141ab53, 0x2748774cdf8eeb99],
    [0x34b0bcb5e19b48a8, 0x391c0cb3c5c95a63, 0x4ed8aa4ae3418acb, 0x5b9cca4f7763e373,
     0x682e6ff3d6b2b8a3, 0x748f82ee5defb2fc, 0x78a5636f43172f60, 0x84c87814a1f0ab72,
     0x8cc702081a6439ec, 0x90befffa23631e28, 0xa4506cebde82bde9, 0xbef9a3f7b2c67915],
    [0xc67178f2e372532b, 0xca273eceea26619c, 0xd186b8c721c0c207, 0xeada7dd6cde0eb1e,
     0xf57d4f7fee6ed178, 0x06f067aa72176fba, 0x0a637dc5a2c898a6, 0x113f9804bef90dae,
     0x1b710b35131c471b, 0x28db77f523047d84, 0x32caab7b40c72493, 0x3c9ebe0a15c9bebc],
    [0x431d67c49c100d4c, 0x4cc5d4becb3e42b6, 0x597f299cfc657e2a, 0x5fcb6fab3ad6faec,
     0x6c44198c4a475817, 0x1429296706ca6351, 0xd5a79147930aa725, 0x06ca6351e003826f,
     0x142929670a0e6e70, 0x27b70a8546d22ffc, 0x2e1b21385c26c926, 0x4d2c6dfc5ac42aed],
    [0x53380d139d95b3df, 0x650a73548baf63de, 0x766a0abb3c77b2a8, 0x81c2c92e47edaee6,
     0x92722c851482353b, 0xa2bfe8a14cf10364, 0xa81a664bbc423001, 0xc24b8b70d0f89791,
     0xc76c51a30654be30, 0xd192e819d6ef5218, 0xd69906245565a910, 0xf40e35855771202a],
    [0x106aa07032bbd1b8, 0x19a4c116b8d2d0c8, 0x1e376c085141ab53, 0x2748774cdf8eeb99,
     0x34b0bcb5e19b48a8, 0x391c0cb3c5c95a63, 0x4ed8aa4ae3418acb, 0x5b9cca4f7763e373,
     0x682e6ff3d6b2b8a3, 0x748f82ee5defb2fc, 0x78a5636f43172f60, 0x84c87814a1f0ab72],
    [0x8cc702081a6439ec, 0x90befffa23631e28, 0xa4506cebde82bde9, 0xbef9a3f7b2c67915,
     0xc67178f2e372532b, 0xca273eceea26619c, 0xd186b8c721c0c207, 0xeada7dd6cde0eb1e,
     0xf57d4f7fee6ed178, 0x06f067aa72176fba, 0x0a637dc5a2c898a6, 0x113f9804bef90dae],
    [0x1b710b35131c471b, 0x28db77f523047d84, 0x32caab7b40c72493, 0x3c9ebe0a15c9bebc,
     0x431d67c49c100d4c, 0x4cc5d4becb3e42b6, 0x597f299cfc657e2a, 0x5fcb6fab3ad6faec,
     0x6c44198c4a475817, 0x1429296706ca6351, 0xd5a79147930aa725, 0x06ca6351e003826f],
    [0x142929670a0e6e70, 0x27b70a8546d22ffc, 0x2e1b21385c26c926, 0x4d2c6dfc5ac42aed,
     0x53380d139d95b3df, 0x650a73548baf63de, 0x766a0abb3c77b2a8, 0x81c2c92e47edaee6,
     0x92722c851482353b, 0xa2bfe8a14cf10364, 0xa81a664bbc423001, 0xc24b8b70d0f89791],
    [0xc76c51a30654be30, 0xd192e819d6ef5218, 0xd69906245565a910, 0xf40e35855771202a,
     0x106aa07032bbd1b8, 0x19a4c116b8d2d0c8, 0x1e376c085141ab53, 0x2748774cdf8eeb99,
     0x34b0bcb5e19b48a8, 0x391c0cb3c5c95a63, 0x4ed8aa4ae3418acb, 0x5b9cca4f7763e373],
    [0x682e6ff3d6b2b8a3, 0x748f82ee5defb2fc, 0x78a5636f43172f60, 0x84c87814a1f0ab72,
     0x8cc702081a6439ec, 0x90befffa23631e28, 0xa4506cebde82bde9, 0xbef9a3f7b2c67915,
     0xc67178f2e372532b, 0xca273eceea26619c, 0xd186b8c721c0c207, 0xeada7dd6cde0eb1e],
    [0xf57d4f7fee6ed178, 0x06f067aa72176fba, 0x0a637dc5a2c898a6, 0x113f9804bef90dae,
     0x1b710b35131c471b, 0x28db77f523047d84, 0x32caab7b40c72493, 0x3c9ebe0a15c9bebc,
     0x431d67c49c100d4c, 0x4cc5d4becb3e42b6, 0x597f299cfc657e2a, 0x5fcb6fab3ad6faec],
    [0x6c44198c4a475817, 0x1429296706ca6351, 0xd5a79147930aa725, 0x06ca6351e003826f,
     0x142929670a0e6e70, 0x27b70a8546d22ffc, 0x2e1b21385c26c926, 0x4d2c6dfc5ac42aed,
     0x53380d139d95b3df, 0x650a73548baf63de, 0x766a0abb3c77b2a8, 0x81c2c92e47edaee6],
    [0x92722c851482353b, 0xa2bfe8a14cf10364, 0xa81a664bbc423001, 0xc24b8b70d0f89791,
     0xc76c51a30654be30, 0xd192e819d6ef5218, 0xd69906245565a910, 0xf40e35855771202a,
     0x106aa07032bbd1b8, 0x19a4c116b8d2d0c8, 0x1e376c085141ab53, 0x2748774cdf8eeb99],
    [0x34b0bcb5e19b48a8, 0x391c0cb3c5c95a63, 0x4ed8aa4ae3418acb, 0x5b9cca4f7763e373,
     0x682e6ff3d6b2b8a3, 0x748f82ee5defb2fc, 0x78a5636f43172f60, 0x84c87814a1f0ab72,
     0x8cc702081a6439ec, 0x90befffa23631e28, 0xa4506cebde82bde9, 0xbef9a3f7b2c67915],
    [0xc67178f2e372532b, 0xca273eceea26619c, 0xd186b8c721c0c207, 0xeada7dd6cde0eb1e,
     0xf57d4f7fee6ed178, 0x06f067aa72176fba, 0x0a637dc5a2c898a6, 0x113f9804bef90dae,
     0x1b710b35131c471b, 0x28db77f523047d84, 0x32caab7b40c72493, 0x3c9ebe0a15c9bebc],
    [0x431d67c49c100d4c, 0x4cc5d4becb3e42b6, 0x597f299cfc657e2a, 0x5fcb6fab3ad6faec,
     0x6c44198c4a475817, 0x1429296706ca6351, 0xd5a79147930aa725, 0x06ca6351e003826f,
     0x142929670a0e6e70, 0x27b70a8546d22ffc, 0x2e1b21385c26c926, 0x4d2c6dfc5ac42aed],
    [0x53380d139d95b3df, 0x650a73548baf63de, 0x766a0abb3c77b2a8, 0x81c2c92e47edaee6,
     0x92722c851482353b, 0xa2bfe8a14cf10364, 0xa81a664bbc423001, 0xc24b8b70d0f89791,
     0xc76c51a30654be30, 0xd192e819d6ef5218, 0xd69906245565a910, 0xf40e35855771202a],
    // Round 26-29 (final full rounds)
    [0x106aa07032bbd1b8, 0x19a4c116b8d2d0c8, 0x1e376c085141ab53, 0x2748774cdf8eeb99,
     0x34b0bcb5e19b48a8, 0x391c0cb3c5c95a63, 0x4ed8aa4ae3418acb, 0x5b9cca4f7763e373,
     0x682e6ff3d6b2b8a3, 0x748f82ee5defb2fc, 0x78a5636f43172f60, 0x84c87814a1f0ab72],
    [0x8cc702081a6439ec, 0x90befffa23631e28, 0xa4506cebde82bde9, 0xbef9a3f7b2c67915,
     0xc67178f2e372532b, 0xca273eceea26619c, 0xd186b8c721c0c207, 0xeada7dd6cde0eb1e,
     0xf57d4f7fee6ed178, 0x06f067aa72176fba, 0x0a637dc5a2c898a6, 0x113f9804bef90dae],
    [0x1b710b35131c471b, 0x28db77f523047d84, 0x32caab7b40c72493, 0x3c9ebe0a15c9bebc,
     0x431d67c49c100d4c, 0x4cc5d4becb3e42b6, 0x597f299cfc657e2a, 0x5fcb6fab3ad6faec,
     0x6c44198c4a475817, 0x1429296706ca6351, 0xd5a79147930aa725, 0x06ca6351e003826f],
    [0x142929670a0e6e70, 0x27b70a8546d22ffc, 0x2e1b21385c26c926, 0x4d2c6dfc5ac42aed,
     0x53380d139d95b3df, 0x650a73548baf63de, 0x766a0abb3c77b2a8, 0x81c2c92e47edaee6,
     0x92722c851482353b, 0xa2bfe8a14cf10364, 0xa81a664bbc423001, 0xc24b8b70d0f89791],
    // Round 28 (full)
    [0xc76c51a30654be30, 0xd192e819d6ef5218, 0xd69906245565a910, 0xf40e35855771202a,
     0x106aa07032bbd1b8, 0x19a4c116b8d2d0c8, 0x1e376c085141ab53, 0x2748774cdf8eeb99,
     0x34b0bcb5e19b48a8, 0x391c0cb3c5c95a63, 0x4ed8aa4ae3418acb, 0x5b9cca4f7763e373],
    // Round 29 (full)
    [0x682e6ff3d6b2b8a3, 0x748f82ee5defb2fc, 0x78a5636f43172f60, 0x84c87814a1f0ab72,
     0x8cc702081a6439ec, 0x90befffa23631e28, 0xa4506cebde82bde9, 0xbef9a3f7b2c67915,
     0xc67178f2e372532b, 0xca273eceea26619c, 0xd186b8c721c0c207, 0xeada7dd6cde0eb1e],
    // Round 30 (full)
    [0xf57d4f7fee6ed178, 0x06f067aa72176fba, 0x0a637dc5a2c898a6, 0x113f9804bef90dae,
     0x1b710b35131c471b, 0x28db77f523047d84, 0x32caab7b40c72493, 0x3c9ebe0a15c9bebc,
     0x431d67c49c100d4c, 0x4cc5d4becb3e42b6, 0x597f299cfc657e2a, 0x5fcb6fab3ad6faec],
];

/// Get MDS matrix entry as Fp
pub fn mds(i: usize, j: usize) -> Fp {
    Fp::new(POSEIDON_MDS[i][j])
}

/// Get round constant as Fp
pub fn rc(round: usize, idx: usize) -> Fp {
    Fp::new(POSEIDON_RC[round][idx])
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_parameters() {
        assert_eq!(POSEIDON_T, 12);
        assert_eq!(POSEIDON_C + POSEIDON_R, POSEIDON_T);
        assert_eq!(POSEIDON_RF + POSEIDON_RP, POSEIDON_TOTAL_ROUNDS);
    }
}
